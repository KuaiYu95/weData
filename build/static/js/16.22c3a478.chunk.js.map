{"version":3,"sources":["api/ajax.tsx","api/index.tsx","containers/FootPrint/index.tsx"],"names":["ajax","url","type","data","urlStr","Object","keys","forEach","key","substring","length","axios","get","post","getTotal","getTimeline","addTimeline","getTodos","addTodos","modifyTodos","delTodos","getFootPrint","addFootPrint","getDiary","addDiary","getUrl","addUrl","TextArea","FootPrint","state","longitude","latitude","zoom","location","title","time","Date","toLocaleDateString","split","join","addMap","isCollect","center","useCluster","markers","events","created","mapInstance","setState","getZoom","click","e","lnglat","lat","lng","markerEvents","marker","extData","getExtData","position","then","res","success","map","it","myLabel","style","width","height","src","alt","concat","this","getTime","openNotification","message","description","duration","target","value","className","amapkey","plugins","name","render","renderMarkerLayout","top","left","padding","fontSize","color","rotate","onClick","bind","onChange","save","placeholder","allowclear","autosize","minRows","maxRows","block","Component"],"mappings":"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","file":"static/js/16.22c3a478.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\nexport default function ajax(url:string = '', type:string = 'GET', data:any = {}):any {\r\n  \r\n  if (type === 'GET') {\r\n    let urlStr = ''\r\n    Object.keys(data).forEach((key) => {\r\n      urlStr += key + '=' + data[key] + '&'\r\n    })\r\n    if(urlStr) {\r\n      urlStr = urlStr.substring(0, urlStr.length - 1)\r\n      url = url + '?' + urlStr\r\n    }\r\n    return axios.get(url)\r\n  } else if (type === 'POST') {\r\n    return axios.post(url, data)\r\n  }\r\n}","import ajax from './ajax'\r\n// 获取首页数据\r\nexport const getTotal = (data:object) => ajax('/get-total', 'GET')\r\n// 获取时间线\r\nexport const getTimeline = (data:object) => ajax('/get-timeline', 'GET')\r\n// 添加时间线\r\nexport const addTimeline = (data:object) => ajax('/add-timeline', 'POST', data)\r\n// 获取 todos\r\nexport const getTodos = (data:object) => ajax('/get-todos', 'GET')\r\n// 添加 todo\r\nexport const addTodos = (data:object) => ajax('/add-todos', 'POST', data)\r\n// 修改 todo\r\nexport const modifyTodos = (data:object) => ajax('/modify-todos', 'POST', data)\r\n// 删除 todo\r\nexport const delTodos = (data:object) => ajax('/del-todos', 'POST', data)\r\n// 获取 足迹\r\nexport const getFootPrint = (data:object) => ajax('/get-foot-print', 'GET')\r\n// 添加 足迹\r\nexport const addFootPrint = (data:object) => ajax('/add-foot-print', 'POST', data)\r\n// 获取 日记\r\nexport const getDiary = (data:object) => ajax('/get-diary', 'GET')\r\n// 添加 日记\r\nexport const addDiary = (data:object) => ajax('/add-diary', 'POST', data)\r\n// 获取 收藏\r\nexport const getUrl = (data:object) => ajax('/get-url', 'GET')\r\n// 添加 收藏\r\nexport const addUrl = (data:object) => ajax('/add-url', 'POST', data)","import React, { Component } from 'react';\nimport { Map, Markers } from 'react-amap';\nimport { getFootPrint, addFootPrint } from '../../api';\nimport { Icon, Tag, Button, Input, notification } from 'antd';\nimport './index.less'\n\nconst TextArea: any = Input.TextArea\nexport default class FootPrint extends Component {\n\n  state = {\n    longitude: '120.060141',\n    latitude: '30.285995',\n    zoom: 0,\n    location: '西溪花园 · 芦雪苑',\n    title: '我们的家',\n    time: new Date().toLocaleDateString().split('/').join('-'),\n    addMap: false,\n    isCollect: true,\n    center: {\n      longitude: 120.059063,\n      latitude: 30.285201\n    },\n    useCluster: false,\n    markers: []\n  }\n\n  componentDidMount() {\n    getFootPrint({}).then((res: any) => {\n      let { success, data } = res.data\n      let { markers } = this.state\n      data = data.map((it: any) => {\n        let myLabel = <img style={{ width: 32, height: 32 }} src=\"https://front-images.oss-cn-hangzhou.aliyuncs.com/i4/a8d30d2a06eeb0d7bb43b0f8275c43ae-48-48.png\" alt=\"\" />\n        return { ...it, myLabel }\n      })\n      success && this.setState({\n        markers: markers.concat(data)\n      })\n    })\n  }\n\n  addFootPrint() {\n    let { longitude, latitude, location, title, markers } = this.state\n    let time = new Date().getTime()\n    let position = { longitude, latitude }\n    let myLabel = <img style={{ width: 32, height: 32 }} src=\"https://front-images.oss-cn-hangzhou.aliyuncs.com/i4/a8d30d2a06eeb0d7bb43b0f8275c43ae-48-48.png\" alt=\"\" />\n    let data = { position, location, title, time }\n    if (longitude && latitude && location && title) {\n      addFootPrint(data).then((res: any) => {\n        let { success } = res.data\n        success && this.setState({\n          addMap: false,\n          markers: [...markers, { ...data, myLabel }],\n          center: { longitude, latitude },\n          isCollect: true,\n        })\n        this.openNotification(success)\n      })\n    } else {\n      notification['error']({\n        message: '操作提示',\n        description: '添加失败，有未填写字段',\n        duration: 2\n      })\n    }\n  }\n\n  openNotification(success: boolean) {\n    success ? notification['success']({\n      message: '操作提示',\n      description: '添加成功，留下 👣 一串串',\n      duration: 2\n    }) :  notification['error']({\n      message: '操作提示',\n      description: '添加失败，请检查网络',\n      duration: 2\n    })\n  };\n\n  events = {\n    created: (mapInstance: any) => {\n      this.setState({ zoom: mapInstance.getZoom() })\n    },\n    click: (e: any) => {\n      this.setState({\n        latitude: e.lnglat.lat,\n        longitude: e.lnglat.lng,\n        isCollect: false,\n      })\n    },\n  }\n\n  markerEvents = {\n    click: (e: any, marker: any) => {\n      const extData = marker.getExtData()\n      const { location, position, time, title } = extData;\n      this.setState({\n        latitude: position.latitude,\n        longitude: position.longitude,\n        location, title,\n        time: time ? new Date(time).toLocaleDateString().split('/').join('-') : new Date().toLocaleDateString().split('/').join('-'),\n        isCollect: true,\n        addMap: false\n      })\n    },\n  }\n\n  renderMarkerLayout(extData: any) {\n    return <div>{extData.myLabel}</div>\n  }\n\n  addMap() {\n    this.setState({\n      addMap: true,\n      title: '',\n      location: '',\n    })\n  }\n\n  save(e: any, type: string) {\n    type === 'location' && this.setState({ location: e.target.value })\n    type === 'title' && this.setState({ title: e.target.value })\n  }\n\n  render() {\n    let { longitude, latitude, location, isCollect, addMap, title } = this.state\n    let plugins: any = [\n      'Scale',\n      { name: 'ToolBar' }\n    ]\n    let card: object = {\n      position: 'absolute',\n      top: '10px',\n      left: '10px',\n      width: 200,\n      padding: '15px',\n      fontSize: 12,\n    }\n    return (\n      <>\n        <div className='map' style={{ width: addMap ? 'calc(100% - 266px)' : '100%' }}>\n          <Map amapkey='ec5816ac0b3be06896d10712b1c815c2' plugins={plugins} center={this.state.center} zoom={15} events={this.events} >\n            <Markers markers={this.state.markers} useCluster={this.state.useCluster} render={this.renderMarkerLayout} events={this.markerEvents} />\n            <div style={card}>\n              {isCollect && <>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" /> 经度: {longitude}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" rotate={90} /> 纬度: {latitude}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"search\" /> 时间: {new Date().toLocaleDateString()}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"environment\" /> 地点: {location}</Tag>\n                <Tag className='tag wrap' color=\"#000\"><Icon type=\"menu\" /> 描述: {title}</Tag>\n              </>}\n              {!isCollect && <>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" /> 经度: {longitude}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" rotate={90} /> 纬度: {latitude}</Tag>\n                <Tag className='tag' color=\"#888E9D\" onClick={this.addMap.bind(this)}><Icon type=\"plus-circle\" /> 未收藏，去添加收藏</Tag>\n              </>}\n            </div>\n          </Map>\n        </div>\n        {addMap && <div className=\"side\">\n          <div className='row-input'>\n            <Icon className='icon' type=\"compass\" />\n            <Input className='input' type='text' value={longitude} onChange={(e: any) => this.save(e, 'longitude')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"compass\" rotate={90} />\n            <Input className='input' type='text' value={latitude} onChange={(e: any) => this.save(e, 'latitude')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"search\" />\n            <Input className='input' type='text' value={new Date().toLocaleDateString()} onChange={(e: any) => this.save(e, 'time')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"environment\" />\n            <Input className='input' type='text' placeholder='请输入地址' onChange={(e: any) => this.save(e, 'location')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"menu\" />\n            <TextArea allowclear=\"true\" autosize={{ minRows: 3, maxRows: 5 }} placeholder='请输入标题' onChange={(e: any) => this.save(e, 'title')} />\n          </div>\n          <div className='form-submit'>\n            <Button block type='primary' onClick={this.addFootPrint.bind(this)}>添加</Button>\n          </div>\n        </div>}\n      </>\n    )\n  }\n}\n"],"sourceRoot":""}