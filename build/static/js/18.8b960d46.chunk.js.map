{"version":3,"sources":["api/ajax.tsx","api/index.tsx","containers/FootPrint/index.tsx"],"names":["ajax","url","type","data","urlStr","Object","keys","forEach","key","substring","length","axios","get","post","confirm","localStorage","getItem","err","getTotal","getTodos","addTodos","message","error","modifyTodos","delTodos","getFootPrint","addFootPrint","getDiary","addDiary","getUrl","addUrl","getBlog","addBlog","getBlogDetail","TextArea","FootPrint","state","longitude","latitude","zoom","location","title","time","Date","toLocaleDateString","split","join","addMap","isCollect","center","useCluster","markers","events","created","mapInstance","setState","getZoom","click","e","lnglat","lat","lng","markerEvents","marker","extData","getExtData","position","then","res","success","map","it","myLabel","style","width","height","src","alt","concat","this","getTime","openNotification","description","duration","target","value","className","amapkey","plugins","name","render","renderMarkerLayout","top","left","padding","fontSize","color","rotate","onClick","bind","onChange","save","placeholder","allowclear","autosize","minRows","maxRows","block","Component"],"mappings":"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","file":"static/js/18.8b960d46.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\nexport default function ajax(url:string = '', type:string = 'GET', data:any = {}):any {\r\n  \r\n  if (type === 'GET') {\r\n    let urlStr = ''\r\n    Object.keys(data).forEach((key) => {\r\n      urlStr += key + '=' + data[key] + '&'\r\n    })\r\n    if(urlStr) {\r\n      urlStr = urlStr.substring(0, urlStr.length - 1)\r\n      url = url + '?' + urlStr\r\n    }\r\n    return axios.get(url)\r\n  } else if (type === 'POST') {\r\n    return axios.post(url, data)\r\n  }\r\n}","import ajax from './ajax'\r\nimport { message } from 'antd'\r\nlet confirm = localStorage.getItem('confirm')\r\nlet err = '对不起，您没有权限'\r\n// 获取 首页数据\r\nexport const getTotal = (data: object) => ajax('/get-total', 'GET')\r\n// 获取 时间线\r\nexport const getTimeline = (data: object) => ajax('/get-timeline', 'GET')\r\n// 添加 时间线\r\nexport const addTimeline = (data: object) => {\r\n  if (confirm !== '0913') {\r\n    message.error(err)\r\n    return\r\n  }\r\n  return ajax('/add-timeline', 'POST', data)\r\n}\r\n// 获取 todos\r\nexport const getTodos = (data: object) => ajax('/get-todos', 'GET')\r\n// 添加 todo\r\nexport const addTodos = (data: object) => {\r\n  if (confirm !== '0913') {\r\n    message.error(err)\r\n    return\r\n  }\r\n  return ajax('/add-todos', 'POST', data)\r\n}\r\n// 修改 todo\r\nexport const modifyTodos = (data: object) => ajax('/modify-todos', 'POST', data)\r\n// 删除 todo\r\nexport const delTodos = (data: object) => ajax('/del-todos', 'POST', data)\r\n// 获取 足迹\r\nexport const getFootPrint = (data: object) => ajax('/get-foot-print', 'GET')\r\n// 添加 足迹\r\nexport const addFootPrint = (data: object) => {\r\n  if (confirm !== '0913') {\r\n    message.error(err)\r\n    return\r\n  }\r\n  return ajax('/add-foot-print', 'POST', data)\r\n}\r\n// 获取 日记\r\nexport const getDiary = (data: object) => ajax('/get-diary', 'GET')\r\n// 添加 日记\r\nexport const addDiary = (data: object) => {\r\n  if (confirm !== '0913') {\r\n    message.error(err)\r\n    return\r\n  }\r\n  return ajax('/add-diary', 'POST', data)\r\n}\r\n// 获取 收藏\r\nexport const getUrl = (data: object) => ajax('/get-url', 'GET')\r\n// 添加 收藏\r\nexport const addUrl = (data: object) => {\r\n  if (confirm !== '0913') {\r\n    message.error(err)\r\n    return\r\n  }\r\n  return ajax('/add-url', 'POST', data)\r\n}\r\n// 获取 收藏\r\nexport const getBlog = (data: object) => ajax('/get-blog', 'GET', data)\r\n// 添加 blog\r\nexport const addBlog = (data: object) => {\r\n  if (confirm !== '0913') {\r\n    message.error(err)\r\n    return\r\n  }\r\n  return ajax('/add-blog', 'POST', data)\r\n}\r\n// 获取 blog详情\r\nexport const getBlogDetail = (data: object) => ajax('/get-blog-detail', 'GET', data)\r\n","import React, { Component } from 'react';\nimport { Map, Markers } from 'react-amap';\nimport { getFootPrint, addFootPrint } from '../../api';\nimport { Icon, Tag, Button, Input, notification } from 'antd';\nimport './index.less'\n\nconst TextArea: any = Input.TextArea\nexport default class FootPrint extends Component {\n\n  state = {\n    longitude: '120.060141',\n    latitude: '30.285995',\n    zoom: 0,\n    location: '西溪花园 · 芦雪苑',\n    title: '我们的家',\n    time: new Date().toLocaleDateString().split('/').join('-'),\n    addMap: false,\n    isCollect: true,\n    center: {\n      longitude: 120.059063,\n      latitude: 30.285201\n    },\n    useCluster: false,\n    markers: []\n  }\n\n  componentDidMount() {\n    getFootPrint({}).then((res: any) => {\n      let { success, data } = res.data\n      let { markers } = this.state\n      data = data.map((it: any) => {\n        let myLabel = <img style={{ width: 32, height: 32 }} src=\"https://front-images.oss-cn-hangzhou.aliyuncs.com/i4/a8d30d2a06eeb0d7bb43b0f8275c43ae-48-48.png\" alt=\"\" />\n        return { ...it, myLabel }\n      })\n      success && this.setState({\n        markers: markers.concat(data)\n      })\n    })\n  }\n\n  addFootPrint() {\n    let { longitude, latitude, location, title, markers } = this.state\n    let time = new Date().getTime()\n    let position = { longitude, latitude }\n    let myLabel = <img style={{ width: 32, height: 32 }} src=\"https://front-images.oss-cn-hangzhou.aliyuncs.com/i4/a8d30d2a06eeb0d7bb43b0f8275c43ae-48-48.png\" alt=\"\" />\n    let data = { position, location, title, time }\n    if (longitude && latitude && location && title) {\n      addFootPrint(data).then((res: any) => {\n        let { success } = res.data\n        success && this.setState({\n          addMap: false,\n          markers: [...markers, { ...data, myLabel }],\n          center: { longitude, latitude },\n          isCollect: true,\n        })\n        this.openNotification(success)\n      })\n    } else {\n      notification['error']({\n        message: '操作提示',\n        description: '添加失败，有未填写字段',\n        duration: 2\n      })\n    }\n  }\n\n  openNotification(success: boolean) {\n    success ? notification['success']({\n      message: '操作提示',\n      description: '添加成功，留下 👣 一串串',\n      duration: 2\n    }) :  notification['error']({\n      message: '操作提示',\n      description: '添加失败，请检查网络',\n      duration: 2\n    })\n  };\n\n  events = {\n    created: (mapInstance: any) => {\n      this.setState({ zoom: mapInstance.getZoom() })\n    },\n    click: (e: any) => {\n      this.setState({\n        latitude: e.lnglat.lat,\n        longitude: e.lnglat.lng,\n        isCollect: false,\n      })\n    },\n  }\n\n  markerEvents = {\n    click: (e: any, marker: any) => {\n      const extData = marker.getExtData()\n      const { location, position, time, title } = extData;\n      this.setState({\n        latitude: position.latitude,\n        longitude: position.longitude,\n        location, title,\n        time: time ? new Date(time).toLocaleDateString().split('/').join('-') : new Date().toLocaleDateString().split('/').join('-'),\n        isCollect: true,\n        addMap: false\n      })\n    },\n  }\n\n  renderMarkerLayout(extData: any) {\n    return <div>{extData.myLabel}</div>\n  }\n\n  addMap() {\n    this.setState({\n      addMap: true,\n      title: '',\n      location: '',\n    })\n  }\n\n  save(e: any, type: string) {\n    type === 'location' && this.setState({ location: e.target.value })\n    type === 'title' && this.setState({ title: e.target.value })\n  }\n\n  render() {\n    let { longitude, latitude, location, isCollect, addMap, title } = this.state\n    let plugins: any = [\n      'Scale',\n      { name: 'ToolBar' }\n    ]\n    let card: object = {\n      position: 'absolute',\n      top: '10px',\n      left: '10px',\n      width: 200,\n      padding: '15px',\n      fontSize: 12,\n    }\n    return (\n      <>\n        <div className='map' style={{ width: addMap ? 'calc(100% - 266px)' : '100%' }}>\n          <Map amapkey='ec5816ac0b3be06896d10712b1c815c2' plugins={plugins} center={this.state.center} zoom={15} events={this.events} >\n            <Markers markers={this.state.markers} useCluster={this.state.useCluster} render={this.renderMarkerLayout} events={this.markerEvents} />\n            <div style={card}>\n              {isCollect && <>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" /> 经度: {longitude}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" rotate={90} /> 纬度: {latitude}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"search\" /> 时间: {new Date().toLocaleDateString()}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"environment\" /> 地点: {location}</Tag>\n                <Tag className='tag wrap' color=\"#000\"><Icon type=\"menu\" /> 描述: {title}</Tag>\n              </>}\n              {!isCollect && <>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" /> 经度: {longitude}</Tag>\n                <Tag className='tag' color=\"#000\"><Icon type=\"compass\" rotate={90} /> 纬度: {latitude}</Tag>\n                <Tag className='tag' color=\"#888E9D\" onClick={this.addMap.bind(this)}><Icon type=\"plus-circle\" /> 未收藏，去添加收藏</Tag>\n              </>}\n            </div>\n          </Map>\n        </div>\n        {addMap && <div className=\"side\">\n          <div className='row-input'>\n            <Icon className='icon' type=\"compass\" />\n            <Input className='input' type='text' value={longitude} onChange={(e: any) => this.save(e, 'longitude')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"compass\" rotate={90} />\n            <Input className='input' type='text' value={latitude} onChange={(e: any) => this.save(e, 'latitude')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"search\" />\n            <Input className='input' type='text' value={new Date().toLocaleDateString()} onChange={(e: any) => this.save(e, 'time')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"environment\" />\n            <Input className='input' type='text' placeholder='请输入地址' onChange={(e: any) => this.save(e, 'location')} />\n          </div>\n          <div className='row-input'>\n            <Icon className='icon' type=\"menu\" />\n            <TextArea allowclear=\"true\" autosize={{ minRows: 3, maxRows: 5 }} placeholder='请输入标题' onChange={(e: any) => this.save(e, 'title')} />\n          </div>\n          <div className='form-submit'>\n            <Button block type='primary' onClick={this.addFootPrint.bind(this)}>添加</Button>\n          </div>\n        </div>}\n      </>\n    )\n  }\n}\n"],"sourceRoot":""}